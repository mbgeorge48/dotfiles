if [ -e $HOME/.pyenv ]; then
    export PYENV_ROOT="$HOME/.pyenv"
    command -v pyenv >/dev/null || export PATH="$PYENV_ROOT/bin:$PATH"
    eval "$(pyenv init -)"
fi

function set_versions_python() {
    if [ -s ".python-version" ]; then
        pyenv install --skip-existing
        pyenv exec python -m venv .env
        if [ -e ".env" ]; then
            .env/bin/pip install -q --upgrade pip
            if [ -s "requirements.txt" ]; then
                .env/bin/pip install -q -r requirements.txt
            fi
            source .env/bin/activate
        fi

    fi
}

set_versions_python
function chpwd {
    set_versions_python
}
