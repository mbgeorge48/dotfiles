if [ -e $HOME/.pyenv ]; then
    export PYENV_ROOT="$HOME/.pyenv"
    [[ -d $PYENV_ROOT/bin ]] && export PATH="$PYENV_ROOT/bin:$PATH"
    eval "$(pyenv init -)"
fi

function set_versions_python() {
    if [ -s ".python-version" ]; then
        pyenv install --skip-existing
        pyenv exec python -m venv .venv
        if [ -e .venv ]; then
            .venv/bin/pip install -q --upgrade pip
            if [ -s requirements.txt ]; then
                .venv/bin/pip install -q -r requirements.txt
            fi
            source .venv/bin/activate
        fi
    fi
}

function chpwd {
    set_versions_python
}
